---
title: "SVM"
author: "Eric"
date: "8 février 2019"
output: ioslides_presentation
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```


```{r, eval = F}
install.packages("e1071")
```

```{r,}
library(e1071)
```

```{r}
setwd(".")
data(iris)
```

```{r, eval = F}
summary(iris)
```


##Jeu de données

Les données que nous allons utiliser sont les mesures effectués sur les iris de Fisher.
Il y a **3** **especes** d'iris :

- Setosa
- Versicolor
- Virginica

La longueur et la largeur des pétales et sépales ont été mesurés sur 50 individus de chaque espèce.

##Répartition des individus selon la taille des sépales

```{r, comment="", fig.align = "center", fig.cap = "Plot"}
plot(iris$Sepal.Length, iris$Sepal.Width, col = iris$Species)
```

##Répartition des individus selon la taille des pétales

```{r, fig.align="center", fig.cap = "Plot"}
plot(iris$Petal.Length, iris$Petal.Width, col = iris$Species)
```

***
On remarque que les individus d'une espece sont très differents des deux autres espèces.
Nous allons utiliser les données sur la taille des pétales (generation d'echantillons aleatoires)

```{r, eval = F}
ech = sample(150,100)
col = c("Petal.Length", "Petal.Width", "Species")
iris1 = iris[ech,col]
iris2 = iris[-ech,col]
```

```{r, fig.align= "center", eval = F}
svm1 = svm(Species ~., data = iris1, kernel = "linear", cost = .1, scale = F)
plot(svm1, iris1[,col])
```

***
Si on utilise les 4 variables aléatoires avec un kernel linéaire.

```{r, fig.align = "center", comment = ""}
model = svm(Species~., data = iris, kernel = "linear")
```

```{r, fig.align = "center"}
plot (model, data=iris, Petal.Width~Petal.Length, slice = list(Sepal.Width = 3, Sepal.Length = 4))
```

Les croix correspondent aux vecteurs de soutient pour chaque classe

##Erreurs de classifications et prediction

On compare les predictions du modèle avec les données actuelles

```{r, fig.align= "center"}
pred = predict(model, iris)
tab = table(predit = pred, actuel = iris$Species)
tab
```

On remarque des erreurs de classification avec le model lineaire.

##Tuning et optimisation de modèle

```{r, fig.align="center"}
model_t = tune(svm, Species~., data = iris, ranges= list(eps = seq(0,1,0.1), cost = 2^(2:9)))
plot (model_t)
```

##Le meilleur modèle

```{r}
mon_modele = model_t$best.model
summary (mon_modele)
```

