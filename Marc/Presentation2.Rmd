---
title: "Stage - Essaie 2"
author: "Marc XU"
date: "8 février 2019"
output: ioslides_presentation
---
## Neuron Network

Neuron Network est une modélisation de la stimulation des neurones sur machine.

Elle est réalisée des outils statistiques.

Avant tout :  
  - installer le packages neuralnet :  (install.packages(neuralnet))
  - utiliser la librairie : library(neuralnet)

## Construire un réseau de neurone avec R

Nous allons reproduire un réseau de neurone avec les données d'iris. 

```{r}
library(neuralnet)
head(iris, 5)
```

La fonction "fix" permet d'ouvrir les données un fichier.  
Utilisation : fix(iris)

## Trainset & Testset

```{r}
ind2 <- sample(2, nrow(iris), replace = T, prob = c(0.7, 0.3))
trainset = iris[ind2 == 1, ]
head(trainset,3)
testset = iris[ind2 == 2, ]
head(testset,3)
table(trainset$Species)
```

## Créer trois colonnes

Ajout de trois colonnes versicolor, setosa and virginica dans trainset
```{r}
trainset$setosa = trainset$Species == "setosa"
trainset$virginica = trainset$Species == "virginica"
trainset$versicolor = trainset$Species == "versicolor"
head(trainset, 2)
```

## Crée le réseau de neurones

Créer le réseau de neurone utilisant la fonction "neuralnet" avec les 3 colonnes dans chaque couche
```{r}
network = neuralnet(versicolor + virginica + setosa ~ Sepal.Length + Sepal.Width + Petal.Length + Petal.Width, data=trainset, hidden = 3, algorithm = "rprop+")
# ou
nn = neuralnet(Species ~ ., data=trainset[,1:5], hidden=1)
plot(nn)
informations = network$result.matrix
informations <- as.data.frame(informations)
```

L'argument "hidden" spécifie le nombre de neurones cachés par couche.

hidden = # : On peut changer le nombres de neurones cachées.  
hidden = c(#, #...) : On peut changer le nombre de couches de neurones (+ nombres de neurones de la couche).

lifesign : une chaîne spécifiant combien de fois la fonction imprimera lors du calcul du réseau de neurones.

## Plot
```{r}
plot(network)
```

## Prediction

```{r}
output1 <- compute(network, trainset[, -c(5:9)])
head(output1$net.result)
amicalement <- apply(output1$net.result, 2, mean)
moy_col <- apply(output1$neurons[[1]], 2, mean)
moy_col <- stack(moy_col)
```

## Prediction - versicolor
```{r}
in_versicolor5 <- informations[4,1] + (informations[5,1]*moy_col[2,1]) + (informations[6,1]*moy_col[3,1]) + (informations[7,1]*moy_col[4,1]) + (informations[8,1]*moy_col[5,1])
out_versicolor5 <- 1/(1+exp(-in_versicolor5))
out_versicolor5

in_versicolor6 <- informations[19,1] + (informations[20,1]*out_versicolor5) + (informations[21,1]*out_versicolor5) + (informations[22,1]*out_versicolor5)
out_versicolor6 <- 1/(1+exp(-in_versicolor6))
out_versicolor6
```

## Prediction - virginica
```{r}
in_virginica5 <- informations[9,1] + (informations[10,1]*moy_col[2,1]) + (informations[11,1]*moy_col[3,1]) + (informations[12,1]*moy_col[4,1]) + (informations[13,1]*moy_col[5,1])
out_virginica5 <- 1/(1+exp(-in_virginica5))
out_virginica5

in_virginica6 <- informations[23,1] + (informations[24,1]*out_virginica5) + (informations[25,1]*out_virginica5) + (informations[26,1]*out_virginica5)
out_virginica6 <- 1/(1+exp(-in_virginica6))
out_virginica6
```

## Prediction - setosa
```{r}
in_setosa5 <- informations[14,1] + (informations[15,1]*moy_col[2,1]) + (informations[16,1]*moy_col[3,1]) + (informations[17,1]*moy_col[4,1]) + (informations[18,1]*moy_col[5,1])
out_setosa5 <- 1/(1+exp(-in_setosa5))
out_setosa5

in_setosa6 <- informations[27,1] + (informations[28,1]*out_setosa5) + (informations[29,1]*out_setosa5) + (informations[30,1]*out_setosa5)
out_setosa6 <- 1/(1+exp(-in_setosa6))
out_setosa6
```

## Lien

https://www.youtube.com/watch?v=YQgVgYcoJHY (début)

https://www.youtube.com/watch?v=-Vs9Vae2KI0 (compléter)
